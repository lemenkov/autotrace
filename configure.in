# configure.in for frontline
#
# Author: Masatake YAMATO (yamato@redhat.com)
#
AC_INIT(fit.c)

AM_INIT_AUTOMAKE(autotrace, "0.24a")

AC_PROG_CC
AC_PROG_CPP
AC_PROG_RANLIB

dnl
dnl ImageMagick
dnl 
HAVE_MAGICK=no
AC_CHECK_PROG(MAGICK_CONFIG, Magick-config, Magick-config, "")
if test "x$MAGICK_CONFIG" = "xMagick-config" ; then
	CPPFLAGS_BACKUP="$CPPFLAGS"
	CPPFLAGS=`Magick-config --cppflags`
	AC_CHECK_HEADER(magick/api.h,
			magick_header_found=yes,
			magick_header_found=no)
	MAGICK_CFLAGS=${CPPFLAGS}
	CPPFLAGS=${CPPFLAGS_BACKUP}

	if test "x${magick_header_found}" = xyes ; then
		MAGICK_LDFLAGS="`Magick-config --ldflags` `Magick-config --libs`"
		AC_SUBST(MAGICK_CFLAGS)
		AC_SUBST(MAGICK_LDFLAGS)
		HAVE_MAGICK=yes
		AC_DEFINE(HAVE_MAGICK)
	else
		MAGICK_CFLAGS=
		AC_MSG_WARN([Magick-config is found but magick/api.h is not found in $MAGICK_CFLAGS])
 		AC_MSG_WARN([Check Magick-config.])
	fi
fi
AM_CONDITIONAL(HAVE_MAGICK, test x$HAVE_MAGICK = xyes)

dnl
dnl PNG
dnl
dnl AC_CHECK_LIB(png, png_create_struct,
dnl 		[LIBS="$LIBS -lpng -lz"
dnl		 HAVE_LIBPNG=no
dnl                 AC_DEFINE(HAVE_LIBPNG)
dnl		],
dnl		[HAVE_LIBPNG=no]
dnl		,-lz)
dnl AM_CONDITIONAL(HAVE_LIBPNG, test x$HAVE_LIBPNG = xyes)

dnl
dnl Vender's cc(not gcc)
dnl
dnl AC_CANONICAL_HOST
dnl if test "x$CC" = xcc ; then
dnl   case host in
dnl 	mips-sgi-irix*)
dnl # Peter Cucka <pcucka at anim.dreamworks.com> wrote:
dnl # > Should I use -Ofast instead of -O2?
dnl # -Ofast selects optimizations that maximize speed, at the expense of
dnl # size, compile time, and, in some cases, floating point accuracy.
dnl # Compiled with -Ofast, AutoTrace runs about twice as fast as with -O2,
dnl # or even -O3, on the two machines (admittedly not a very extensive
dnl # sample) on which I've tested it.  I'd recommend using -Ofast, but
dnl # it's not necessary.
dnl            CFLAGS=-Ofast
dnl            ;;
dnl 	*)
dnl	    ;;
dnl  esac
dnl fi

AC_OUTPUT(Makefile)
